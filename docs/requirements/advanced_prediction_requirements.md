# 高度な予測機能 要件定義書

## 1. 概要

「スターゲイザー」アプリケーションの高度予測機能モジュールは、ユーザーに対して詳細で正確な占星術的予測を提供するシステムです。このモジュールは既存のネイタルチャート解析機能を拡張し、サターンリターン、拡張プログレッション、リターントランジット、複合的予測システムを実装します。

## 2. 目的

- ユーザーの人生における重要な転機や周期を占星術的視点から予測・解釈する
- 複数の予測技法を統合し、より精度の高い未来予測を提供する
- 専門的な占星術知識をわかりやすい形でユーザーに提示する

## 3. 機能要件

### 3.1 サターンリターン計算・解釈機能

| 要件ID | 要件名 | 説明 | 優先度 |
|--------|--------|------|--------|
| SR-01 | サターンリターン計算 | 出生図のサターン位置に対するトランジットサターンの回帰時期を自動計算 | 高 |
| SR-02 | 回帰期間の詳細表示 | サターンリターン前後の±6ヶ月を含む影響期間を表示 | 中 |
| SR-03 | 複数回帰の計算 | 第1回（28-30歳）、第2回（56-60歳）、第3回（84-90歳）のリターン計算 | 高 |
| SR-04 | ハウス位置考慮解釈 | ネイタルチャートにおけるサターンのハウス位置を考慮した解釈文生成 | 高 |
| SR-05 | アスペクト考慮解釈 | サターンとの主要アスペクトを考慮した複合解釈文生成 | 中 |
| SR-06 | リターン時の社会状況 | サターンリターン時の年齢に基づく一般的な社会・人生状況の解説 | 低 |

### 3.2 プログレッション拡張機能

| 要件ID | 要件名 | 説明 | 優先度 |
|--------|--------|------|--------|
| PR-01 | ソーラーアーク実装 | ネイタルの太陽進行度に基づく全天体進行計算 | 高 |
| PR-02 | シンボリックプログレッション | 1日=1年、1度=1年などの異なる進行法計算オプション | 中 |
| PR-03 | プログレッションチャート | 二次進行、ソーラーアーク、シンボリック進行を表示するチャート | 高 |
| PR-04 | プログレッション天体表 | 進行天体の黄道位置、速度、ハウス位置のテーブル表示 | 中 |
| PR-05 | プログレッション専用解釈 | 進行天体のサイン変化、ハウス移動、新アスペクトの解釈文 | 高 |
| PR-06 | 時期指定プログレッション | ユーザー指定日付でのプログレッションチャート計算 | 中 |

### 3.3 リターントランジット機能

| 要件ID | 要件名 | 説明 | 優先度 |
|--------|--------|------|--------|
| RT-01 | ソーラーリターン計算 | 年次太陽回帰図の自動計算と表示 | 高 |
| RT-02 | ルナーリターン計算 | 月次月回帰図の自動計算と表示 | 中 |
| RT-03 | ヴィーナスリターン計算 | 約8年周期の金星回帰図の計算と表示 | 中 |
| RT-04 | リターンチャート | 回帰図のホロスコープチャート表示 | 高 |
| RT-05 | リターン天体表 | 回帰図の天体位置、ハウスカスプ、感受点のテーブル表示 | 中 |
| RT-06 | リターン-ネイタル比較 | 回帰図とネイタル図の重要な相違点ハイライト | 高 |
| RT-07 | 年間予測レポート | ソーラーリターンに基づく1年間の予測レポート生成 | 高 |

### 3.4 複合的予測システム

| 要件ID | 要件名 | 説明 | 優先度 |
|--------|--------|------|--------|
| PS-01 | アニュアルプロフェクション | 古代占星術の年間予測技法の実装 | 中 |
| PS-02 | フィルダリア計算 | 惑星周期に基づく人生期間支配星の計算 | 低 |
| PS-03 | 時間因子法 | 天体運行速度に基づくイベントタイミング予測 | 中 |
| PS-04 | ディレクション | 一次ディレクション計算と解釈 | 低 |
| PS-05 | 統合予測タイムライン | 複数予測システムを統合した時系列表示 | 高 |
| PS-06 | 重要時期アラート | 複数技法で強調される重要時期の警告システム | 高 |

### 3.5 人生の重要イベント予測拡張

| 要件ID | 要件名 | 説明 | 優先度 |
|--------|--------|------|--------|
| LF-01 | 結婚時期予測 | 結婚可能性が高まる期間の高精度予測 | 高 |
| LF-02 | 関係性変化予測 | 既存関係の転機・試練期間の予測 | 高 |
| LF-03 | キャリア転機予測 | 職業変化、昇進、転職の可能性時期予測 | 高 |
| LF-04 | 経済状況予測 | 財務状況の変化や機会の予測 | 中 |
| LF-05 | 健康リスク予測 | 健康面で注意が必要な期間の予測と対策アドバイス | 中 |
| LF-06 | 引越し・移動予測 | 居住地変更や海外移住の好機予測 | 低 |

## 4. 非機能要件

### 4.1 パフォーマンス要件

- 各予測計算は3秒以内に完了すること
- 複合予測システムは5秒以内にレンダリングされること
- モバイルデバイスでも快適に動作すること

### 4.2 信頼性要件

- 天文計算の精度はSwiss Ephemerisの標準に準拠すること
- システムは99.5%以上の稼働率を維持すること
- 予測データは定期的にバックアップされること

### 4.3 セキュリティ要件

- ユーザーの出生データは暗号化して保存すること
- 個人情報保護法に準拠した情報管理を行うこと
- セキュリティ監査を定期的に実施すること

### 4.4 ユーザビリティ要件

- 専門知識がなくても理解できる解釈文を提供すること
- モバイル端末でも読みやすいレイアウトであること
- 予測結果はPDF形式でエクスポート可能であること

## 5. データ要件

- 天体位置計算用の最新天文暦（Swiss Ephemeris）
- 解釈文生成用の占星術テキストデータベース
- ユーザープロファイルと設定データ

## 6. インターフェース要件

- 既存のネイタルチャート表示システムとの統合
- 予測結果表示用の専用ダッシュボード
- 時間軸ベースの予測イベント表示インターフェース

## 7. 制約事項

- 計算精度を維持しつつも、ブラウザベースの処理能力の制限内に収めること
- モバイルデバイスのスクリーンサイズに対応したレスポンシブデザイン
- データベース容量の制限内での解釈テキスト保存

## 8. 想定ユーザー

- 占星術初心者から中級者
- 自己啓発や人生設計に関心のあるユーザー
- 人生の転機に直面しているユーザー

## 9. 成功基準

- ユーザーの90%以上が予測結果を「役立つ」と評価
- 予測機能が原因のアプリケーションクラッシュが0件
- 予測機能実装後のユーザー継続率10%向上 